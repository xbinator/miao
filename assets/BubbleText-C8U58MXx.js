var L=Object.defineProperty;var R=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var V=(n,e,a)=>e in n?L(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a,k=(n,e)=>{for(var a in e||(e={}))x.call(e,a)&&V(n,a,e[a]);if(R)for(var a of R(e))z.call(e,a)&&V(n,a,e[a]);return n};import{J as s,aS as E,E as A,aT as g,w,aw as t,q as j,aU as U,aE as S,aC as b,aK as c,aV as D,aH as H,s as $,aB as q,aD as M,aL as C,aP as J,A as N,C as K,aW as P,U as W,aR as X,aX as F}from"./index-DhbetlwR.js";function O(n,e){const a=s(()=>!!E(n)),p={step:5,interval:50},r=s(()=>{const u=E(n);return k(k({},p),typeof u=="object"?u:{})}),f=s(()=>r.value.step),T=s(()=>r.value.interval),y=A(e.value),o=A(1),v=s(()=>a.value&&g(e.value));let l=null;function B(){o.value=t(o)+f.value,l=null}function h(){l&&clearTimeout(l),l=null}w(e,()=>{const u=t(y);y.value=e.value,!v.value&&g(e.value)?o.value=e.value.length:g(e.value)&&g(u)&&e.value.indexOf(u)!==0&&(o.value=1,h())}),w([o,a,e],()=>{v.value&&g(e.value)&&t(o)<e.value.length&&!l&&(l=setTimeout(B,T.value))},{immediate:!0});const d=s(()=>v.value?e.value.slice(0,o.value):e.value),m=s(()=>v.value&&t(o)<e.value.length);return[d,m]}const G=["innerHTML"],Q=["textContent"],Y=j({__name:"MessageRender",props:{mode:{default:"text"},content:{default:""}},setup(n){const e=n,[a]=D("message-render"),p=s(()=>U(e.content));return(r,f)=>r.mode==="markdown"?(b(),S("div",{key:0,class:c(t(a)),innerHTML:p.value},null,10,G)):(b(),S("div",{key:1,class:c(t(a)),textContent:H(r.content)},null,10,Q))}}),ae=j({__name:"BubbleText",props:{typing:{type:[Object,Boolean],default:!1},content:{default:""},reasonContent:{default:""},placement:{},avatar:{type:[Object,Boolean]},loading:{type:Boolean},isCollapse:{type:Boolean,default:!0},collapseOptions:{},size:{},toolbar:{type:[Boolean,Array]},feedback:{}},emits:["actions"],setup(n,{emit:e}){const a=n,p=e,r=s(()=>a.content),f=s(()=>a.reasonContent),[T,y]=O(()=>a.typing,r),[o,v]=O(()=>a.typing,f),l=s(()=>y.value||v.value),B=s(()=>l.value?"output":"complete"),[h,d]=D("bubble-text"),m=$({reason:!1});function u(){m.reason=!m.reason}function I(i){p("actions",i)}return w(()=>[l.value,a.loading],()=>l.value&&a.loading&&p("actions",{name:"typing-complete"}),{immediate:!0}),(i,_)=>(b(),q(t(F),{placement:i.placement,avatar:i.avatar,loading:i.loading,status:B.value,toolbar:i.toolbar,"is-collapse":i.isCollapse,onActions:I},{avatar:M(()=>[X(i.$slots,"avatar")]),default:M(()=>[C("div",{class:c([t(h)])},[i.reasonContent?(b(),S("div",{key:0,class:c(t(d)("reason-wrapper"))},[C("div",{class:c(t(d)("reason-title"))},[_[0]||(_[0]=C("div",null,"深度思考",-1)),N(t(P),{type:"",class:c(t(d)("reason-collapse")),rotate:m.reason?180:0,onClick:u},null,8,["class","rotate"])],2),K(C("div",{class:c(t(d)("reason"))},H(t(o)),3),[[W,!m.reason]])],2)):J("",!0),N(Y,{content:t(T),mode:i.placement==="left"?"markdown":"text"},null,8,["content","mode"])],2)]),_:3},8,["placement","avatar","loading","status","toolbar","is-collapse"]))}});export{ae as default};
