var q=Object.defineProperty;var E=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var R=(a,e,t)=>e in a?q(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,T=(a,e)=>{for(var t in e||(e={}))z.call(e,t)&&R(a,t,e[t]);if(E)for(var t of E(e))D.call(e,t)&&R(a,t,e[t]);return a};import{J as s,aS as S,E as _,aT as m,w as h,aw as n,q as A,aU as P,aE as N,aC as M,aK as c,aV as U,s as $,aB as J,aD as H,aL as C,aP as K,A as B,C as W,aW as X,U as F,aR as G,aX as Q}from"./index-CDzUXvPv.js";import{t as Y}from"./toString-C5xU7OsJ.js";function Z(a){return function(e){return a==null?void 0:a[e]}}var x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ee=Z(x),I=/[&<>"']/g,ae=RegExp(I.source);function te(a){return a=Y(a),a&&ae.test(a)?a.replace(I,ee):a}function V(a,e){const t=s(()=>!!S(a)),p={step:5,interval:50},d=s(()=>{const u=S(a);return T(T({},p),typeof u=="object"?u:{})}),g=s(()=>d.value.step),b=s(()=>d.value.interval),y=_(e.value),r=_(1),v=s(()=>t.value&&m(e.value));let o=null;function w(){r.value=n(r)+g.value,o=null}function k(){o&&clearTimeout(o),o=null}h(e,()=>{const u=n(y);y.value=e.value,!v.value&&m(e.value)?r.value=e.value.length:m(e.value)&&m(u)&&e.value.indexOf(u)!==0&&(r.value=1,k())}),h([r,t,e],()=>{v.value&&m(e.value)&&n(r)<e.value.length&&!o&&(o=setTimeout(w,b.value))},{immediate:!0});const i=s(()=>v.value?e.value.slice(0,r.value):e.value),f=s(()=>v.value&&n(r)<e.value.length);return[i,f]}const ne=["data-effect","innerHTML"],O=A({__name:"MessageRender",props:{isMarkdown:{type:Boolean,default:!1},content:{default:""},effect:{default:null}},setup(a){const e=a,[t]=U("message-render"),p=s(()=>e.isMarkdown?P(e.content):te(e.content));return(d,g)=>(M(),N("div",{class:c(n(t)),"data-effect":d.effect,innerHTML:p.value},null,10,ne))}}),ue=A({__name:"BubbleText",props:{typing:{type:[Object,Boolean],default:!1},content:{default:""},reasonContent:{default:""},isMarkdown:{type:Boolean},placement:{},avatar:{type:[Object,Boolean]},loading:{type:Boolean},isCollapse:{type:Boolean,default:!0},collapseOptions:{},size:{},toolbar:{type:[Boolean,Array]},feedback:{}},emits:["actions"],setup(a,{emit:e}){const t=a,p=e,d=s(()=>t.content),g=s(()=>t.reasonContent),[b,y]=V(()=>t.typing,d),[r,v]=V(()=>t.typing,g),o=s(()=>y.value||v.value),w=s(()=>o.value?"output":"complete"),[k,i]=U("bubble-text"),f=$({reason:!1}),u=s(()=>o.value?"typing":null);function L(){f.reason=!f.reason}function j(l){p("actions",l)}return h(()=>[o.value,t.loading],()=>o.value&&t.loading&&p("actions",{name:"typing-complete"}),{immediate:!0}),(l,se)=>(M(),J(n(Q),{placement:l.placement,avatar:l.avatar,loading:l.loading,status:w.value,toolbar:l.toolbar,"is-collapse":l.isCollapse,onActions:j},{avatar:H(()=>[G(l.$slots,"avatar")]),default:H(()=>[C("div",{class:c([n(k)])},[l.reasonContent?(M(),N("div",{key:0,class:c(n(i)("reason"))},[C("div",{class:c(n(i)("reason-toggle")),onClick:L},[C("div",{class:c(n(i)("reason-title"))},"深度思考",2),B(n(X),{type:"",class:c(n(i)("reason-collapse")),rotate:f.reason?180:0},null,8,["class","rotate"])],2),W(C("div",{class:c(n(i)("reason-content"))},[B(O,{effect:u.value,content:n(r),"is-markdown":l.isMarkdown},null,8,["effect","content","is-markdown"])],2),[[F,!f.reason]])],2)):K("",!0),B(O,{effect:u.value,content:n(b),"is-markdown":l.isMarkdown},null,8,["effect","content","is-markdown"])],2)]),_:3},8,["placement","avatar","loading","status","toolbar","is-collapse"]))}});export{ue as default};
