var L=Object.defineProperty;var _=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var E=(a,e,t)=>e in a?L(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,w=(a,e)=>{for(var t in e||(e={}))N.call(e,t)&&E(a,t,e[t]);if(_)for(var t of _(e))j.call(e,t)&&E(a,t,e[t]);return a};import{J as s,aS as S,E as H,aT as f,w as M,aw as n,q as V,aU as q,aE as z,aC as A,aK as u,aV as U,s as D,aB as $,aW as J,aD as C,aL as k,C as K,A as B,aX as P,U as W,aR as X,aY as Y}from"./index-Br7T19uY.js";import{t as x}from"./toString-DtNGuYat.js";function F(a){return function(e){return a==null?void 0:a[e]}}var G={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Q=F(G),I=/[&<>"']/g,Z=RegExp(I.source);function ee(a){return a=x(a),a&&Z.test(a)?a.replace(I,Q):a}function O(a,e){const t=s(()=>!!S(a)),p={step:5,interval:50},m=s(()=>{const c=S(a);return w(w({},p),typeof c=="object"?c:{})}),g=s(()=>m.value.step),y=s(()=>m.value.interval),h=H(e.value),o=H(1),d=s(()=>t.value&&f(e.value));let i=null;function b(){o.value=n(o)+g.value,i=null}function r(){i&&clearTimeout(i),i=null}M(e,()=>{const c=n(h);h.value=e.value,!d.value&&f(e.value)?o.value=e.value.length:f(e.value)&&f(c)&&e.value.indexOf(c)!==0&&(o.value=1,r())}),M([o,t,e],()=>{d.value&&f(e.value)&&n(o)<e.value.length&&!i&&(i=setTimeout(b,y.value))},{immediate:!0});const v=s(()=>d.value?e.value.slice(0,o.value):e.value),T=s(()=>d.value&&n(o)<e.value.length);return[v,T]}const ae=["innerHTML"],R=V({__name:"MessageRender",props:{isMarkdown:{type:Boolean,default:!1},content:{default:""}},setup(a){const e=a,[t]=U("message-render"),p=s(()=>e.isMarkdown?q(e.content):ee(e.content));return(m,g)=>(A(),z("div",{class:u(n(t)),innerHTML:p.value},null,10,ae))}}),oe=V({__name:"BubbleText",props:{typing:{type:[Object,Boolean],default:!1},content:{default:""},think:{default:""},isMarkdown:{type:Boolean},placement:{},avatar:{type:[Object,Boolean]},loading:{type:Boolean},isCollapse:{type:Boolean,default:!0},collapseOptions:{},size:{},state:{},toolbar:{type:[Boolean,Array]},feedback:{}},emits:["actions"],setup(a,{emit:e}){const t=a,p=e,m=s(()=>t.content),g=s(()=>t.think),[y,h]=O(()=>t.typing,m),[o,d]=O(()=>t.typing,g),i=s(()=>h.value||d.value),b=s(()=>t.state!=="complete"?t.state:i.value?"output":"complete"),[,r]=U("bubble-text"),v=D({think:!1});function T(){v.think=!v.think}function c(l){p("actions",l)}return M(()=>[i.value,t.loading],()=>i.value&&t.loading&&p("actions",{name:"typing-complete"}),{immediate:!0}),(l,te)=>(A(),$(n(Y),{placement:l.placement,avatar:l.avatar,loading:l.loading,state:b.value,toolbar:l.toolbar,"is-collapse":l.isCollapse,onActions:c},J({avatar:C(()=>[X(l.$slots,"avatar")]),default:C(()=>[k("div",{class:u(n(r)("content"))},[B(R,{content:n(y),"is-markdown":l.isMarkdown},null,8,["content","is-markdown"])],2)]),_:2},[l.think?{name:"top",fn:C(()=>[k("div",{class:u(n(r)("think"))},[k("div",{class:u(n(r)("think-toggle")),onClick:T},[k("div",{class:u(n(r)("think-title"))},"深度思考",2),B(n(P),{type:"",class:u(n(r)("think-collapse")),rotate:v.think?180:0},null,8,["class","rotate"])],2),K(k("div",{class:u(n(r)("think-content"))},[B(R,{content:n(o),"is-markdown":l.isMarkdown},null,8,["content","is-markdown"])],2),[[W,!v.think]])],2)]),key:"0"}:void 0]),1032,["placement","avatar","loading","state","toolbar","is-collapse"]))}});export{oe as default};
