var I=Object.defineProperty;var S=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var _=(a,e,t)=>e in a?I(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,w=(a,e)=>{for(var t in e||(e={}))L.call(e,t)&&_(a,t,e[t]);if(S)for(var t of S(e))N.call(e,t)&&_(a,t,e[t]);return a};import{J as l,aS as E,E as H,aT as f,w as M,aw as n,q as V,aU as j,aE as q,aC as A,aK as c,aV as U,s as z,aB as $,aW as J,aD as C,aL as k,C as K,A as B,aH as P,aX as W,U as X,aR as Y,aY as F}from"./index-74UM7pkD.js";import{t as G}from"./toString-C9hbrRu7.js";function Q(a){return function(e){return a==null?void 0:a[e]}}var Z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},x=Q(Z),D=/[&<>"']/g,ee=RegExp(D.source);function ae(a){return a=G(a),a&&ee.test(a)?a.replace(D,x):a}function O(a,e){const t=l(()=>!!E(a)),p={step:5,interval:50},m=l(()=>{const u=E(a);return w(w({},p),typeof u=="object"?u:{})}),g=l(()=>m.value.step),y=l(()=>m.value.interval),h=H(e.value),o=H(1),d=l(()=>t.value&&f(e.value));let i=null;function b(){o.value=n(o)+g.value,i=null}function r(){i&&clearTimeout(i),i=null}M(e,()=>{const u=n(h);h.value=e.value,!d.value&&f(e.value)?o.value=e.value.length:f(e.value)&&f(u)&&e.value.indexOf(u)!==0&&(o.value=1,r())}),M([o,t,e],()=>{d.value&&f(e.value)&&n(o)<e.value.length&&!i&&(i=setTimeout(b,y.value))},{immediate:!0});const v=l(()=>d.value?e.value.slice(0,o.value):e.value),T=l(()=>d.value&&n(o)<e.value.length);return[v,T]}const te=["innerHTML"],R=V({__name:"MessageRender",props:{isMarkdown:{type:Boolean,default:!1},content:{default:""}},setup(a){const e=a,[t]=U("message-render"),p=l(()=>e.isMarkdown?j(e.content):ae(e.content));return(m,g)=>(A(),q("div",{class:c(n(t)),innerHTML:p.value},null,10,te))}}),ie=V({__name:"BubbleText",props:{typing:{type:[Object,Boolean],default:!1},content:{default:""},think:{default:""},thinkTitle:{},isMarkdown:{type:Boolean},placement:{},avatar:{type:[Object,Boolean]},loading:{type:Boolean},isCollapse:{type:Boolean,default:!0},collapseOptions:{},size:{},state:{},toolbar:{type:[Boolean,Array]},feedback:{}},emits:["actions"],setup(a,{emit:e}){const t=a,p=e,m=l(()=>t.content),g=l(()=>t.think),[y,h]=O(()=>t.typing,m),[o,d]=O(()=>t.typing,g),i=l(()=>h.value||d.value),b=l(()=>t.state!=="complete"?t.state:i.value?"output":"complete"),[,r]=U("bubble-text"),v=z({think:!1});function T(){v.think=!v.think}function u(s){p("actions",s)}return M(()=>[i.value,t.loading],()=>i.value&&t.loading&&p("actions",{name:"typing-complete"}),{immediate:!0}),(s,ne)=>(A(),$(n(F),{placement:s.placement,avatar:s.avatar,loading:s.loading,state:b.value,toolbar:s.toolbar,"is-collapse":s.isCollapse,onActions:u},J({avatar:C(()=>[Y(s.$slots,"avatar")]),default:C(()=>[k("div",{class:c(n(r)("content"))},[B(R,{content:n(y),"is-markdown":s.isMarkdown},null,8,["content","is-markdown"])],2)]),_:2},[s.think?{name:"top",fn:C(()=>[k("div",{class:c(n(r)("think"))},[k("div",{class:c(n(r)("think-toggle")),onClick:T},[k("div",{class:c(n(r)("think-title"))},P(s.thinkTitle||"深度思考"),3),B(n(W),{type:"",class:c(n(r)("think-collapse")),rotate:v.think?180:0},null,8,["class","rotate"])],2),K(k("div",{class:c(n(r)("think-content"))},[B(R,{content:n(o),"is-markdown":s.isMarkdown},null,8,["content","is-markdown"])],2),[[X,!v.think]])],2)]),key:"0"}:void 0]),1032,["placement","avatar","loading","state","toolbar","is-collapse"]))}});export{ie as default};
